?dmvnorm
install.packages('mvtnorm')
?dgamma
synth_reg
numrow
rownum
colnum
numcol
?numcol
nrow
library(mvtnorm)
library(heavy)
?heavy
?heavyLm
heavyLm(t ~ 0 + Phy, synth_reg)
lm(t ~ 0 + Phy, synth_reg)
heavyLm(t ~ 0 + Phy, synth_reg)
lm(t ~ 0 + Phy, synth_reg)
heavyLm(t ~ 0 + Phy, synth_reg, family=Student(df = 2))
heavyLm(t ~ 0 + Phy, synth_reg, family=Student(df = 10))
lm(t ~ 0 + Phy, synth_reg)
em(synth_reg$t, synth_reg$X)
nrow(synth_reg$X)
em(synth_reg$t, synth_reg$Phy)
em(synth_reg$t, synth_reg$Phy)
em(synth_reg$t, synth_reg$Phy)
em(synth_reg$t, synth_reg$Phy)
t
em(synth_reg$t, synth_reg$Phy)
heavyLm(t ~ 0 + Phy, synth_reg, family=Student(df = 10))
em(synth_reg$t, synth_reg$Phy)
em(synth_reg$t, synth_reg$Phy)
tail(c(1,2,3,4), -1)
em(synth_reg$t, synth_reg$Phy)
em(synth_reg$t, synth_reg$Phy)
em(synth_reg$t, synth_reg$Phy)
synth_reg$t[0]
synth_reg$t
synth_reg$t[[0]]
synth_reg$t[1]
synth_reg$t[2]
synth_reg$Phy[1]
synth_reg$Phy[1,]
em(synth_reg$t, synth_reg$Phy)
em(synth_reg$t, synth_reg$Phy)
?dmvnorm
em(synth_reg$t, synth_reg$Phy)
em(synth_reg$t, synth_reg$Phy)
em(synth_reg$t, synth_reg$Phy)
em(synth_reg$t, synth_reg$Phy)
em(synth_reg$t, synth_reg$Phy)
em(synth_reg$t, synth_reg$Phy)
em(synth_reg$t, synth_reg$Phy)
em(synth_reg$t, synth_reg$Phy)
em(synth_reg$t, synth_reg$Phy)
em(synth_reg$t, synth_reg$Phy)
em(synth_reg$t, synth_reg$Phy)
em(synth_reg$t, synth_reg$Phy)
em(synth_reg$t, synth_reg$Phy)
em(synth_reg$t, synth_reg$Phy)
em(synth_reg$t, synth_reg$Phy)
em(synth_reg$t, synth_reg$Phy)
em(synth_reg$t, synth_reg$Phy)
em(synth_reg$t, synth_reg$Phy)
em(synth_reg$t, synth_reg$Phy)
em(synth_reg$t, synth_reg$Phy)
em(synth_reg$t, synth_reg$Phy)
em(synth_reg$t, synth_reg$Phy)
em(synth_reg$t, synth_reg$Phy)
em(synth_reg$t, synth_reg$Phy)
em(synth_reg$t, synth_reg$Phy)
em(synth_reg$t, synth_reg$Phy)
em(synth_reg$t, synth_reg$Phy)
em(synth_reg$t, synth_reg$Phy)
4**2
1e+6
1e+6 + 2
em(synth_reg$t, synth_reg$Phy, iter = 100)
em(synth_reg$t, synth_reg$Phy, iter = 10)
warnings()
em(synth_reg$t, synth_reg$Phy, iter = 30)
o.robust <- optim(params, fn = loglik.robust, method=c("CG"), X = synth_reg$Phy, t = synth_reg$t, nu = 10)
o.robust$pars[:30]
o.robust$pars[1:30]
o.robust$par[1:30]
o.robust$par
plot(gamma(1,1))
plot(rgamma(1,1))
plot(function (x) rgamma(x, 1,1))
plot(function (x) dgamma(x, 1,1))
?dgamma
plot(function (x) pgamma(x, 1,1))
plot(dnorm)
plot(dnorm, xlim=c(-1,1))
plot(dgamma, xlim=c(-1,1))
plot(function(x) dgamma(x, 1,1), xlim=c(-1,1))
plot(function(x) dgamma(x, 1,1), xlim=c(0,5))
plot(function(x) dgamma(x, 0,1), xlim=c(0,5))
plot(function(x) dgamma(x, 0,0), xlim=c(0,5))
plot(function(x) dgamma(x, 1,0), xlim=c(0,5))
plot(function(x) dgamma(x, 1,0.2), xlim=c(0,5))
plot(function(x) dgamma(x, 0.1,0.2), xlim=c(0,5))
plot(function(x) dgamma(x, 0.2,0.2), xlim=c(0,5))
plot(function(x) dgamma(x, 1,0), xlim=c(0,5))
o.robust <- optim(params, fn = loglik.robust, method=c("CG"), X = synth_reg$Phy, t = synth_reg$t, nu = 2)
o.robust <- optim(params, fn = loglik.robust, method=c("CG"), X = synth_reg$Phy, t = synth_reg$t, nu = 3)
o.robust$par[1:30]
heavyLm(t ~ 0 + Phy, synth_reg, family=Student(df = 10))
lm(t ~ 0 + Phy, synth_reg)
heavyLm(t ~ 0 + Phy, synth_reg, family=Student(df = 1))
em(synth_reg$t, synth_reg$Phy)
em(synth_reg$t, synth_reg$Phy, iter=30)
em(synth_reg$t, synth_reg$Phy, iter=30)
e+02 + 1
e+02
2e+02
em(synth_reg$t, synth_reg$Phy, iter=30)
lm(t ~ 0 + Phy, synth_reg)
em(synth_reg$t, synth_reg$Phy, iter=30)
lm(t ~ 0 + Phy, synth_reg)
em(synth_reg$t, synth_reg$Phy, iter=100)
lm(t ~ Phy, synth_reg)
em(synth_reg$t, synth_reg$Phy, iter=100)
lm(t ~ Phy, synth_reg)
em(synth_reg$t, synth_reg$Phy, iter=100)$Theta
em(synth_reg$t, synth_reg$Phy, iter=100)$Theta
em(synth_reg$t, synth_reg$Phy, iter=100)$w
lm(t ~ Phy, synth_reg)
em(synth_reg$t, synth_reg$Phy, iter=100)
em(synth_reg$t, synth_reg$Phy, iter=100)
em(synth_reg$t, synth_reg$Phy, iter=100)
em(synth_reg$t, synth_reg$Phy, iter=100)
em(synth_reg$t, synth_reg$Phy, iter=100)
em(synth_reg$t, synth_reg$Phy, iter=100)
em(synth_reg$t, synth_reg$Phy, iter=100)
em(synth_reg$t, synth_reg$Phy, iter=100)
em(synth_reg$t, synth_reg$Phy, iter=100)
em(synth_reg$t, synth_reg$Phy, iter=100)
em(synth_reg$t, synth_reg$Phy, iter=100)
weights = em(synth_reg$t, synth_reg$Phy, iter=100)$Z
weights
lm(t ~ Phy, synth_reg, weights = weights)
em(synth_reg$t, synth_reg$Phy, iter=100)$w
lm(t ~ Phy, synth_reg)
lm(t ~ Phy, synth_reg, weights = weights)
summary(lm(t ~ Phy, synth_reg, weights = weights))
X <- synth_reg$Phy
t(X) %*% diag(weights) %*% X
sqrt(diag(t(X) %*% diag(weights) %*% X))
em(synth_reg$t, synth_reg$Phy, iter=100)$q
q <- em(synth_reg$t, synth_reg$Phy, iter=100)$q
q
sqrt(q * diag(t(X) %*% diag(weights) %*% X))
summary(lm(t ~ Phy, synth_reg, weights = weights))
sqrt(q * diag(solve(t(X) %*% diag(weights) %*% X)))
sqrt(diag(solve(q * t(X) %*% diag(weights) %*% X)))
sqrt(diag(solve(1/q * t(X) %*% diag(weights) %*% X)))
sqrt(diag(solve(1/q * t(X) %*% diag(weights) %*% X)))
sqrt(diag(solve(1/q * t(X) %*% diag(weights) %*% X))) * 1.96
summary(lm(t ~ Phy, synth_reg, weights = weights))
summary(lm(t ~ Phy, synth_reg, weights = weights))
sqrt(diag(solve(1/q * t(X) %*% diag(weights) %*% X))) * 1.96
sqrt(diag(solve(q * t(X) %*% diag(weights) %*% X))) * 1.96
summary(lm(t ~ Phy, synth_reg))
X
std.err(X, q)
summary(lm(t ~ Phy, synth_reg, weights = weights))
X <- cbind(rep(1, nrow(X)),X)
std.err(X, q)
summary(lm(t ~ Phy, synth_reg, weights = weights))
std.err(X, q)
em(synth_reg$t, synth_reg$Phy, iter=100)$w
class(res)
library(dplyr)
library(ggplot2)
res$w
length(res$w)
?layout
linear.model
linear.model$par
linear.model$pars
parameters(linear.model)
class(linear.model)
residuals(linear.model)
wls.resid <- residuals(lm(t ~ Phy, synth_reg, weights = weights), type = "deviance")
wls.resid
plot(function(x) dgamma(x, 50,50), xlim=c(0,5))
plot(function(x) dgamma(x, 1,0), xlim=c(0,5))
plot(function(x) dgamma(x, 1.5,.5), xlim=c(0,5))
plot(function(x) dgamma(x, 4.5,3.5), xlim=c(0,5))
plot(function(x) dgamma(x, 8/2,2), xlim=c(0,5))
plot(function(x) dgamma(x, 20/2,2), xlim=c(0,5))
plot(function(x) dgamma(x, 1,2), xlim=c(0,5))
plot(function(x) dgamma(x, 1,2), xlim=c(0,5))
plot(function(x) dgamma(x, .5,2), xlim=c(0,5))
plot(function(x) dgamma(x, 5.5,4.5), xlim=c(0,5))
plot(function(x) dgamma(x, 5.5,2), xlim=c(0,5))
plot(function(x) dgamma(x, 5.5,4.5), xlim=c(0,5))
plot(function(x) dgamma(x, 5.5,2), xlim=c(0,5))
plot(function(x) dgamma(x, 5.5,4.5), xlim=c(0,5))
plot(function(x) dgamma(x, 5.5,2), xlim=c(0,5))
summary(lmHeavy(t ~ Phy, synth_reg))
summary(heavyLm(t ~ Phy, synth_reg))
summary(heavyLm(t ~ Phy, synth_reg, family=Student(df = 5)))
summary(lm(t ~ Phy, synth_reg, weights = weights))
summary(heavyLm(t ~ Phy, synth_reg, family=Student(df = 10)))
summary(lm(t ~ Phy, synth_reg, weights = weights))
plot(function(x) dgamma(x, 50.5,49.5), xlim=c(0,5))
em(synth_reg$t, synth_reg$Phy, iter=100)
em(synth_reg$t, synth_reg$Phy, iter=10)
em(synth_reg$t, synth_reg$Phy, iter=10)
em(synth_reg$t, synth_reg$Phy, iter=10)
em(synth_reg$t, synth_reg$Phy, iter=10)
em(synth_reg$t, synth_reg$Phy, iter=10)
em(synth_reg$t, synth_reg$Phy, iter=10)
em(synth_reg$t, synth_reg$Phy, iter=10)
em(synth_reg$t, synth_reg$Phy, iter=10)
em(synth_reg$t, synth_reg$Phy, iter=10)$ll
em(synth_reg$t, synth_reg$Phy, iter=20)$ll
em(synth_reg$t, synth_reg$Phy, iter=20)$ll
em(synth_reg$t, synth_reg$Phy, iter=20)$ll
linear.model
em(synth_reg$t, synth_reg$Phy, iter=20)$ll
em(synth_reg$t, synth_reg$Phy, iter=20)$ll
em(synth_reg$t, synth_reg$Phy, iter=20)$ll
em(synth_reg$t, synth_reg$Phy, iter=20)$w
em(synth_reg$t, synth_reg$Phy, iter=20, nu = 2)$w
em(synth_reg$t, synth_reg$Phy, iter=20, nu = 4)$w
em(synth_reg$t, synth_reg$Phy, iter=20, nu = 4)$w
em(synth_reg$t, synth_reg$Phy, iter=20, nu = 4)$ll
em(synth_reg$t, synth_reg$Phy, iter=20, nu = 4)$ll
em(synth_reg$t, synth_reg$Phy, iter=20, nu = 4)$ll
wls.resid
deviance
res
deviance(X, synth_reg$t, res$w, res$q %*% diag(res$Z))
deviance(X, synth_reg$t, res$w, 1 / (res$q * diag(res$Z)))
res$q * res*Z
res$q * res$Z
T/res$q * res$Z
()T - X %*% W)/res$q * res$Z
(T - X %*% W)/res$q * res$Z
(T - X %*% res$w)/res$q * res$Z
(T - X %*% res$w)^2/(res$q * res$Z)
head((T - X %*% res$w)^2/(res$q * res$Z))
head(wls.resid)
head((T - X %*% res$w)^2)
head((T - X %*% res$w))
head(wls.resid)
head(wls.resid, 20)
head((T - X %*% res$w), 20)
summary(lm(t ~ Phy, synth_reg, weights = weights))
res$w
head(residuals(lm(t ~ Phy, synth_reg, weights = weights)), 20)
head((T - X %*% res$w), 20)
head(wls.resid, 20)
head(residuals(lm(t ~ Phy, synth_reg, weights = weights), type="deviance"), 20)
head(residuals(lm(t ~ Phy, synth_reg, weights = weights), type="pearson"), 20)
head(residuals(lm(t ~ Phy, synth_reg, weights = weights), type=c("pearson")), 20)
head(residuals(lm(t ~ Phy, synth_reg, weights = weights), type=c("deviance")), 20)
head(residuals(lm(t ~ Phy, synth_reg, weights = weights), type=c("working")), 20)
head((T - X %*% res$w)/sqrt(X %*% res$w), 20)
head((T - X %*% res$w)/sqrt(X %*% res$w), 20)
sign(0)
sign(5)
sign(-5)
deviance(X, T, w)
t <- synth_res$t
t <- synth_reg$t
deviance(X, T, w)
T <- synth_reg$t
deviance(X, T, w)
t
deviance(X, T, w)
deviance(X, T, res$w)
plot(T, X %*% res$w)
abs
abs(-5)
deviance(X, T, res$w)
deviance(X, T, res$w)
log(-5)
?residuals
head((T - X %*% res$w), 20)
head((T - X %*% res$w) * res$Z, 20)
head((T - X %*% res$w) * res$Z * res$q, 20)
head((T - X %*% res$w)^2 * res$Z * res$q, 20)
head(residuals(lm(t ~ Phy, synth_reg, weights = weights), type="pearson"), 20)
head(residuals(lm(t ~ Phy, synth_reg, weights = weights), type="deviance"), 20)
head(res$Z)
head(weights)
head((T - X %*% res$w)^2 * res$Z * res$q, 20)
head((T - X %*% res$w), 20)
head((X %*% res$w)/T, 20)
head(T/(X %*% res$w), 20)
?lm
summary(linear.model)
logLik(linear.model)
logLik(linear.model) * 2
tail(res$ll, 1) - logLik(linear.model)
likelihood(T, X, res$Z, c(res$q, res$w), 10, FALSE)
plot(-2 * likelihood(T, X, res$Z, c(res$q, res$w), 10, FALSE))
boxplot(-2 * likelihood(T, X, res$Z, c(res$q, res$w), 10, FALSE))
plot(-2 * likelihood(T, X, res$Z, c(res$q, res$w), 10, FALSE))
logLik(lm)
logLik(linear.model)
linear.model
?linear.model
linear.model.fitted.values
fitted.values(linear.model)
plot(dev.robust)
sd(X)
plot(dev.lm)
?sd
sd(X)
res <- em(synth_reg$t, synth_reg$Phy, iter=10)
res <- em(synth_reg$t, synth_reg$Phy, iter=10)
res <- em(synth_reg$t, synth_reg$Phy, iter=10)
res <- em(synth_reg$t, synth_reg$Phy, iter=10)
res <- em(synth_reg$t, synth_reg$Phy, iter=10)
res <- em(synth_reg$t, synth_reg$Phy, iter=10)
res <- em(synth_reg$t, synth_reg$Phy, iter=10)
res <- em(synth_reg$t, synth_reg$Phy, iter=10)
res <- em(synth_reg$t, synth_reg$Phy, iter=10)
res <- em(synth_reg$t, synth_reg$Phy, iter=10)
res <- em(synth_reg$t, synth_reg$Phy, iter=10)
res <- em(synth_reg$t, synth_reg$Phy, iter=10)
res$w
res$ll
plot(dev.robust)
plot(dev.lm)
rmvnorm
diag(5)
plot(sim.lm)
sim.lm
length(as.vector(sim.lm))
plot(as.vector(sim.lm))
?quantile
quantile(as.vector(sim.lm), c(99))
quantile(as.vector(sim.lm), c(.99))
dev.sim
dev.sim
plot(dev.sim)
plot(as.vector(dev.sim))
plot(as.vector(dev.sim))
quantile(as.vector(dev.sim), .99)
plot(dev.lm)
plot(as.vector(dev.sim))
rn <- rnorm(100, 0, 1)
rn
dnorm(rn, 0, 1)
dnorm(rn, 0, 1, log=TRUE)
-2 * dnorm(rn, 0, 1, log=TRUE)
quantile(-2 * dnorm(rnorm(1000), 0, 1, log=TRUE), .99)
quantile(-2 * dnorm(rnorm(1000, 0, sd(X)), 0, sd(X), log=TRUE), .99)
quantile(-2 * dnorm(rnorm(1000, 0, sd(X)), 0, sd(X), log=TRUE), .99)
quantile(-2 * dnorm(rnorm(1000, 0, sd(X)), 0, sd(X), log=TRUE), .99)
quantile(-2 * dnorm(rnorm(1000, 0, sd(X)), 0, sd(X), log=TRUE), .99)
quantile(-2 * dnorm(rnorm(1000, 0, sd(X)), 0, sd(X), log=TRUE), .99)
quantile(-2 * dnorm(rnorm(1000, 0, sd(X)), 0, sd(X), log=TRUE), .99)
quantile(-2 * dnorm(rnorm(1000, 0, sd(X)), 0, sd(X), log=TRUE), .99)
quantile(-2 * dnorm(rnorm(1000, 0, sd(X)), 0, sd(X), log=TRUE), .99)
quantile(-2 * dnorm(rnorm(1000, 0, sd(X)), 0, sd(X), log=TRUE), .99)
quantile(-2 * dmvnorm(rmvnorm(1000, 0, diag(1/(res$q * Z))), sigma = diag(1/(res$q * Z))log=TRUE), .99)
quantile(-2 * dmvnorm(rmvnorm(1000, 0, diag(1/(res$q * Z))), sigma = diag(1/(res$q * Z)), log=TRUE), .99)
quantile(-2 * dmvnorm(rmvnorm(1000, 0, diag(1/(res$q * res$Z))), sigma = diag(1/(res$q * Z)), log=TRUE), .99)
quantile(-2 * dmvnorm(rmvnorm(1000, sigma = diag(1/(res$q * res$Z))), sigma = diag(1/(res$q * Z)), log=TRUE), .99)
quantile(-2 * dmvnorm(rmvnorm(1000, sigma = diag(1/(res$q * res$Z))), sigma = diag(1/(res$q * res$Z)), log=TRUE), .99)
quantile(-2 * dmvnorm(rmvnorm(1000, sigma = diag(1/(res$q * res$Z))), sigma = diag(1/(res$q * res$Z)), log=TRUE), .99)
quantile(-2 * dmvnorm(rmvnorm(1000, sigma = diag(1/(res$q * res$Z))), sigma = diag(1/(res$q * res$Z)), log=TRUE), .99)
quantile(-2 * dmvnorm(rmvnorm(300, sigma = diag(1/(res$q * res$Z))), sigma = diag(1/(res$q * res$Z)), log=TRUE), .99)
quantile(-2 * dmvnorm(rmvnorm(300, sigma = diag(1/(res$q * res$Z))), sigma = diag(1/(res$q * res$Z)), log=TRUE), .99)
quantile(-2 * dmvnorm(rmvnorm(300, sigma = diag(1/(res$q * res$Z))), sigma = diag(1/(res$q * res$Z)), log=TRUE), .99)
lm.sim.q
robust.sim.q
data.frame(residuals = dev.robust)
data.frame(residuals = dev.robust, model = "robust")
res$se
residuals(lm)
summary(lm.mode)
summary(lm.model)
lm.coef
lm.coef[, 2]
res$ll
res.2$ll
res.2$ll
res.2$w
lm.coef
TRUE && FALSE
!FALSE
2 <= 5
5++
i += 1

res.2 <- em(synth_reg$t, X, iter=100, nu=3000)

res.2 <- em(synth_reg$t, X, iter=100, nu=3000)

res.2 <- em(synth_reg$t, X, iter=100, nu=3000)
res.2$ll

res.2 <- em(synth_reg$t, X, iter=100, nu=4)
res.2$ll

res.2 <- em(synth_reg$t, X, iter=100, nu=10)
res.2$ll

res.2 <- em(synth_reg$t, X, iter=100, nu=3000)
res.2$ll

res.2 <- em(synth_reg$t, X, iter=100, nu=3000, tol=Inf)
res.2$ll

res.2 <- em(synth_reg$t, X, iter=100, nu=3000, tol=-Inf)
res.2$ll

res.2 <- em(synth_reg$t, X, iter=20, nu=10, tol=-Inf)
res.2$ll
res.2$w


lm(synth_reg$t ~ X, weights = res.2$Z )

res.3 <- em(synth_reg$t, X, iter=20, nu=300, tol=-Inf)
res.3$w
lm.coef
dgamma(1, 10/2, 10/2 -1, log=TRUE)
res$ll
res$ll
?dnorrm
?dnorm
res$ll
log(0)
res$ll
plot(function(x) dnorm(x, log=TRUE), -60, 50)
plot(function(x) dnorm(x), -60, 50)
plot(function(x) dnorm(x), -5,5)
plot(function(x) dnorm(x, log=TRUE), -5,5)
res$ll
?dnorm
res$ll
res$w
o.robust <- optim(params, fn = loglik.robust, method=c("CG"), X = X, t = synth_reg$t, nu = 100)
o.robust$pars[1:21]
o.robust$par[1:21]
o.robust$par[1:31]
lm.coef
res <- em(synth_reg$t, X, iter=100)
res$ll
res$ll
res$ll
res$ll
res$ll
res.2$ll

res.2 <- em(synth_reg$t, X, iter=20, nu=200, tol=-Inf)
res.2$ll
res.2 <- em(synth_reg$t, X, iter=20, nu=2000, tol=-Inf)
res.2$ll
res.2 <- em(synth_reg$t, X, iter=20, nu=3, tol=-Inf)
res.2$ll
res.2$q
res.2$w
res.2 <- em(synth_reg$t, X, iter=20, nu=3, tol=-Inf)
res.2$ll
res$ll
res.2 <- em(synth_reg$t, X, iter=100)
res.2$ll
?diff
res.2$ll
diff(res.2$ll)
cross.validation(synth_reg$t, X, 1, em)
cross.validation(synth_reg$t, X, 1, em)
cross.validation(synth_reg$t, X, em)
cross.validation(synth_reg$t, X, em)
cross.validation(synth_reg$t, X, em, c(3,4,5,6,7))
range(1:20, 3)
range(1:20)
range(1,20)
res$Z
res <- em(synth_reg$t, X, iter=100, nu = 3)
res$Z
model_robust
res <- em(synth_reg$t, X, nu = 2.8)
res$Z
model_robust
res
?dt
res
